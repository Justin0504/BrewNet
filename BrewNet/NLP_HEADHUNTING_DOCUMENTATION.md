# BrewNet NLP Headhunting ç³»ç»Ÿæ–‡æ¡£

> **ç‰ˆæœ¬**: 1.0  
> **æ›´æ–°æ—¥æœŸ**: 2024-11-21  
> **ç»´æŠ¤è€…**: BrewNet Team Heady  
> **åˆ†æ”¯**: nlp branch

---

## ç›®å½•

1. [åŠŸèƒ½æ¦‚è¿°](#åŠŸèƒ½æ¦‚è¿°)
2. [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
3. [ç”¨æˆ·äº¤äº’æµç¨‹](#ç”¨æˆ·äº¤äº’æµç¨‹)
4. [ç‰¹å¾ç³»ç»Ÿ](#ç‰¹å¾ç³»ç»Ÿ)
5. [æ–‡æœ¬å¤„ç†](#æ–‡æœ¬å¤„ç†)
6. [åŒ¹é…é€»è¾‘è¯¦è§£](#åŒ¹é…é€»è¾‘è¯¦è§£)
7. [è¯„åˆ†ç®—æ³•](#è¯„åˆ†ç®—æ³•)
8. [ä»£ç å®ç°](#ä»£ç å®ç°)
9. [ä½¿ç”¨ç¤ºä¾‹](#ä½¿ç”¨ç¤ºä¾‹)
10. [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
11. [æœªæ¥æ‰©å±•](#æœªæ¥æ‰©å±•)

---

## åŠŸèƒ½æ¦‚è¿°

### ä»€ä¹ˆæ˜¯ Headhuntingï¼Ÿ

Headhunting æ˜¯ BrewNet çš„æ™ºèƒ½äººæ‰æœç´¢åŠŸèƒ½ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡**è‡ªç„¶è¯­è¨€æè¿°**ä»–ä»¬æƒ³è¦è¿æ¥çš„äººï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä»ç”¨æˆ·æ± ä¸­æ‰¾åˆ°æœ€åŒ¹é…çš„ Top 5 å€™é€‰äººã€‚

### æ ¸å¿ƒç‰¹ç‚¹

âœ¨ **è‡ªç„¶è¯­è¨€è¾“å…¥**
- ç”¨æˆ·å¯ä»¥ç”¨è‡ªç„¶è¯­è¨€æè¿°éœ€æ±‚
- æ— éœ€å­¦ä¹ å¤æ‚çš„æœç´¢è¯­æ³•
- æ”¯æŒå¤šç§è¡¨è¾¾æ–¹å¼

ğŸ¯ **æ™ºèƒ½åŒ¹é…**
- ç»“åˆæ¨èç³»ç»Ÿå’Œæ–‡æœ¬åŒ¹é…
- å¤šç»´åº¦ç‰¹å¾ç»¼åˆè¯„åˆ†
- ä¸Šä¸‹æ–‡ç†è§£ï¼ˆæ ¡å‹ã€mentorã€å¹´é™ç­‰ï¼‰

âš¡ **å®æ—¶åé¦ˆ**
- å³æ—¶è¿”å› Top 5 ç»“æœ
- æ˜¾ç¤ºåŒ¹é…æ’åå’Œç†ç”±
- æ”¯æŒæ·±å…¥æŸ¥çœ‹å€™é€‰äººèµ„æ–™

ğŸ”’ **éšç§ä¿æŠ¤**
- å°Šé‡ç”¨æˆ·éšç§è®¾ç½®
- æ’é™¤å·²è¿æ¥/å·²æ‹’ç»çš„ç”¨æˆ·
- æ”¯æŒè®¢é˜…é™åˆ¶

### ä½¿ç”¨åœºæ™¯

| åœºæ™¯ | æŸ¥è¯¢ç¤ºä¾‹ | åŒ¹é…é‡ç‚¹ |
|-----|---------|---------|
| å¯»æ‰¾æ ¡å‹ | "alumni from Stanford" | æ•™è‚²èƒŒæ™¯åŒ¹é… |
| å¯»æ‰¾å¯¼å¸ˆ | "experienced mentor in tech" | Mentoræ„å›¾ + å·¥ä½œç»éªŒ |
| å¯»æ‰¾åˆ›ä¸šè€… | "startup founder with AI background" | èŒä¸šé˜¶æ®µ + æŠ€èƒ½ |
| å¯»æ‰¾ç‰¹å®šç»éªŒ | "5 years experience in product management" | å·¥ä½œå¹´é™ + èŒä½ |
| å¯»æ‰¾å…¬å¸èƒŒæ™¯ | "works at Google or Facebook" | å½“å‰å…¬å¸ |

---

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æµç¨‹å›¾

```
ç”¨æˆ·è¾“å…¥è‡ªç„¶è¯­è¨€æŸ¥è¯¢
        â†“
    æ–‡æœ¬é¢„å¤„ç†
    â”œâ”€ åˆ†è¯ (Tokenization)
    â”œâ”€ æå–å…³é”®è¯
    â””â”€ æå–æ•°å­—
        â†“
    è·å–æ¨èå€™é€‰æ± 
    (RecommendationService)
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ··åˆè¯„åˆ†ç³»ç»Ÿ         â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ æ¨èåˆ†æ•° (30%) â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â”‚          +            â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚  â”‚ æ–‡æœ¬åŒ¹é… (70%) â”‚  â”‚
    â”‚  â”‚ â”œâ”€å…³é”®è¯åŒ¹é…   â”‚  â”‚
    â”‚  â”‚ â”œâ”€å¹´é™åŒ¹é…     â”‚  â”‚
    â”‚  â”‚ â”œâ”€æ ¡å‹åŒ¹é…     â”‚  â”‚
    â”‚  â”‚ â”œâ”€MentoråŒ¹é…   â”‚  â”‚
    â”‚  â”‚ â””â”€FounderåŒ¹é…  â”‚  â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
    æŒ‰åˆ†æ•°é™åºæ’åº
        â†“
    è¿”å› Top 5 ç»“æœ
        â†“
    å±•ç¤ºå€™é€‰äººå¡ç‰‡
```

### æ¨¡å—åˆ’åˆ†

| æ¨¡å— | æ–‡ä»¶ | èŒè´£ |
|-----|------|------|
| **å‰ç«¯ç•Œé¢** | `ExploreView.swift` | ç”¨æˆ·äº¤äº’ã€ç»“æœå±•ç¤º |
| **æ–‡æœ¬å¤„ç†** | `ExploreView.swift` (tokenize, extractNumbers) | åˆ†è¯ã€æ•°å­—æå– |
| **æ¨èå¼•æ“** | `RecommendationService.swift` | è·å–å€™é€‰æ±  |
| **åŒ¹é…é€»è¾‘** | `ExploreView.swift` (rankRecommendations) | æ–‡æœ¬åŒ¹é…è¯„åˆ† |
| **ç”¨æˆ·ç‰¹å¾** | `ProfileModels.swift`, `UserTowerFeatures.swift` | ç‰¹å¾å®šä¹‰ |
| **æ•°æ®æœåŠ¡** | `SupabaseService.swift` | æ•°æ®è·å– |

---

## ç”¨æˆ·äº¤äº’æµç¨‹

### 1. æœç´¢ç•Œé¢

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬29-110è¡Œ

```swift
struct ExploreMainView: View {
    @State private var descriptionText: String = ""
    @State private var recommendedProfiles: [BrewNetProfile] = []
    @State private var isLoading = false
    
    var body: some View {
        VStack {
            headerSection          // æ ‡é¢˜å’Œè¯´æ˜
            descriptionSection     // æè¿°æ–‡å­—
            inputSection          // æ–‡æœ¬è¾“å…¥æ¡†
            actionButton          // "Find Matches" æŒ‰é’®
            statusSection         // åŠ è½½/é”™è¯¯çŠ¶æ€
            resultsSection        // Top 5 ç»“æœåˆ—è¡¨
        }
    }
}
```

#### ç•Œé¢å…ƒç´ 

| å…ƒç´  | è¯´æ˜ | ä»£ç è¡Œ |
|-----|------|--------|
| **Header** | "Headhunting" æ ‡é¢˜ | 114-122 |
| **Description** | åŠŸèƒ½è¯´æ˜æ–‡å­— | 125-129 |
| **Input Field** | å¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡† | 131-158 |
| **Search Button** | "Find Matches" æŒ‰é’® | 160-174 |
| **Status** | åŠ è½½çŠ¶æ€/é”™è¯¯æç¤º | 176-206 |
| **Results** | ç»“æœå¡ç‰‡åˆ—è¡¨ | 209-230 |

#### è¾“å…¥ç¤ºä¾‹ï¼ˆPlaceholderï¼‰
```
"alumni, works at a top tech company, three years of experience, open to mentoring"
```

### 2. æœç´¢æ‰§è¡Œ

**è§¦å‘**: ç‚¹å‡» "Find Matches" æŒ‰é’®  
**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬237-303è¡Œ

```swift
private func runHeadhuntingSearch() {
    // 1. éªŒè¯è¾“å…¥
    guard !trimmed.isEmpty else { ... }
    guard let currentUser = authManager.currentUser else { ... }
    
    // 2. è·å–å½“å‰ç”¨æˆ·èµ„æ–™ï¼ˆç”¨äºæ ¡å‹åŒ¹é…ï¼‰
    if currentUserProfile == nil {
        currentUserProfile = try? await supabaseService.getProfile(userId: currentUser.id)
    }
    
    // 3. è·å–æ¨èå€™é€‰æ± ï¼ˆ60äººï¼‰
    let recommendations = try await recommendationService.getRecommendations(
        for: currentUser.id,
        limit: 60,
        forceRefresh: true
    )
    
    // 4. æ–‡æœ¬åŒ¹é…æ’åº
    let ranked = rankRecommendations(
        recommendations, 
        query: trimmed, 
        currentUserProfile: currentUserProfile
    )
    
    // 5. å– Top 5
    let topProfiles = Array(ranked.prefix(5))
    
    // 6. è·å– Pro/Verified çŠ¶æ€
    fetchedProIds = try await supabaseService.getProUserIds(from: topIds)
    fetchedVerifiedIds = try await supabaseService.getVerifiedUserIds(from: topIds)
    
    // 7. æ›´æ–° UI
    self.recommendedProfiles = topProfiles
}
```

### 3. ç»“æœå±•ç¤º

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬539-691è¡Œ

```swift
struct HeadhuntingResultCard: View {
    let profile: BrewNetProfile
    let rank: Int              // 1-5 æ’å
    var isEngaged: Bool        // æ˜¯å¦å·²äº’åŠ¨
    
    var body: some View {
        VStack {
            // æ’åæ ‡ç­¾
            Text("#\(rank)")
            
            // ç”¨æˆ·ä¿¡æ¯
            HStack {
                profileImage
                VStack {
                    Text(profile.coreIdentity.name)
                    Text(primaryHeadline)      // èŒä½ Â· å…¬å¸
                    Text(location)
                    Text(bio)
                }
            }
            
            // æŠ€èƒ½æ ‡ç­¾ï¼ˆå‰3ä¸ªï¼‰
            HStack {
                ForEach(skillsPreview) { skill in
                    Text(skill)
                }
            }
        }
        .onTapGesture {
            // æ‰“å¼€è¯¦ç»†èµ„æ–™å¼¹çª—
            selectedProfile = profile
        }
    }
}
```

#### ç»“æœå¡ç‰‡æ˜¾ç¤ºå†…å®¹

| ä¿¡æ¯ | æ¥æºå­—æ®µ | è¯´æ˜ |
|-----|---------|------|
| **æ’å** | è®¡ç®—å¾—å‡º | #1 - #5 |
| **å¤´åƒ** | `coreIdentity.profileImage` | åœ†å½¢å¤´åƒ |
| **å§“å** | `coreIdentity.name` | ç”¨æˆ·å…¨å |
| **èŒä½Â·å…¬å¸** | `jobTitle` Â· `currentCompany` | ä¸»è¦æ ‡é¢˜ |
| **ä½ç½®** | `coreIdentity.location` | åŸå¸‚ |
| **ç®€ä»‹** | `coreIdentity.bio` | ä¸ªäººç®€ä»‹ï¼ˆ3è¡Œï¼‰ |
| **æŠ€èƒ½** | `skills` (å‰3ä¸ª) | æŠ€èƒ½æ ‡ç­¾ |
| **èŒä¸šé˜¶æ®µ** | `careerStage` | å³ä¸Šè§’æ˜¾ç¤º |
| **å·²äº’åŠ¨æ ‡è¯†** | è®¡ç®—å¾—å‡º | âœ“ æ ‡è®° |

### 4. å€™é€‰äººè¯¦æƒ…

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬703-798è¡Œ

ç‚¹å‡»ç»“æœå¡ç‰‡åï¼Œå±•å¼€å…¨å±èµ„æ–™å¡ï¼š

```swift
struct HeadhuntingProfileCardSheet: View {
    let profile: BrewNetProfile
    let isPro: Bool
    let isVerifiedOverride: Bool?
    
    var body: some View {
        NavigationStack {
            ScrollView {
                // å®Œæ•´çš„ç”¨æˆ·èµ„æ–™å¡
                UserProfileCardPreview(profile: profile)
            }
            
            // åº•éƒ¨æ“ä½œæŒ‰é’®
            if shouldShowActions {
                HStack {
                    // å‘é€ä¸´æ—¶æ¶ˆæ¯
                    Button { handleTemporaryChatTap() }
                    
                    // å‘é€å’–å•¡èŠå¤©é‚€è¯·
                    Button { handleConnectTap() }
                }
            }
        }
    }
}
```

---

## ç‰¹å¾ç³»ç»Ÿ

### å¯æœç´¢æ–‡æœ¬èšåˆ

Headhunting ä¼šå°†ç”¨æˆ·çš„å¤šä¸ªå­—æ®µèšåˆæˆä¸€ä¸ªå¯æœç´¢çš„æ–‡æœ¬ï¼Œç”¨äºå…³é”®è¯åŒ¹é…ã€‚

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬404-441è¡Œ

```swift
private func aggregatedSearchableText(for profile: BrewNetProfile) -> String {
    var parts: [String] = []
    
    // 1. åŸºæœ¬ä¿¡æ¯
    parts.append(profile.coreIdentity.name)
    parts.append(profile.coreIdentity.bio ?? "")
    parts.append(profile.coreIdentity.location ?? "")
    
    // 2. èŒä¸šä¿¡æ¯
    parts.append(profile.professionalBackground.currentCompany ?? "")
    parts.append(profile.professionalBackground.jobTitle ?? "")
    parts.append(profile.professionalBackground.industry ?? "")
    parts.append(profile.professionalBackground.education ?? "")
    
    // 3. æŠ€èƒ½å’Œè®¤è¯
    parts.append(contentsOf: profile.professionalBackground.skills)
    parts.append(contentsOf: profile.professionalBackground.certifications)
    parts.append(contentsOf: profile.professionalBackground.languagesSpoken)
    
    // 4. ç¤¾äº¤ç‰¹å¾
    parts.append(profile.personalitySocial.selfIntroduction ?? "")
    parts.append(contentsOf: profile.personalitySocial.valuesTags)
    parts.append(contentsOf: profile.personalitySocial.hobbies)
    
    // 5. æ•™è‚²ç»å†ï¼ˆè¯¦ç»†ï¼‰
    if let educations = profile.professionalBackground.educations {
        for education in educations {
            parts.append(education.schoolName)
            parts.append(education.fieldOfStudy ?? "")
            parts.append(education.degree.displayName)
        }
    }
    
    // 6. å·¥ä½œç»å†ï¼ˆè¯¦ç»†ï¼‰
    for experience in profile.professionalBackground.workExperiences {
        parts.append(experience.companyName)
        parts.append(experience.position ?? "")
        parts.append(contentsOf: experience.highlightedSkills)
        parts.append(experience.responsibilities ?? "")
    }
    
    // è½¬å°å†™å¹¶æ‹¼æ¥
    return parts.joined(separator: " ").lowercased()
}
```

### ç‰¹å¾å­—æ®µæ±‡æ€»

| ç±»åˆ« | å­—æ®µ | æƒé‡ | ç¤ºä¾‹ |
|-----|------|------|------|
| **åŸºæœ¬ä¿¡æ¯** | name, bio, location | é«˜ | "John Doe, San Francisco" |
| **èŒä¸šä¿¡æ¯** | currentCompany, jobTitle, industry | é«˜ | "Google, Product Manager, Tech" |
| **æŠ€èƒ½** | skills, certifications, languages | ä¸­ | ["Python", "Leadership"] |
| **æ•™è‚²** | schoolName, fieldOfStudy, degree | é«˜ï¼ˆæ ¡å‹åŒ¹é…ï¼‰ | "Stanford, CS, Bachelor's" |
| **å·¥ä½œç»å†** | companyName, position, skills | ä¸­ | "Meta, Engineer" |
| **ç¤¾äº¤** | valuesTags, hobbies, selfIntroduction | ä½ | ["Innovation", "Hiking"] |

---

## æ–‡æœ¬å¤„ç†

### 1. åˆ†è¯ (Tokenization)

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬412-417è¡Œ

```swift
private func tokenize(_ text: String) -> [String] {
    text
        .lowercased()
        .components(separatedBy: CharacterSet.alphanumerics.inverted)
        .filter { !$0.isEmpty }
}
```

#### å¤„ç†æµç¨‹

```
è¾“å…¥: "alumni from Stanford, 5 years experience"
  â†“
è½¬å°å†™: "alumni from stanford, 5 years experience"
  â†“
æŒ‰éå­—æ¯æ•°å­—å­—ç¬¦åˆ†å‰²: ["alumni", "from", "stanford", "5", "years", "experience"]
  â†“
è¿‡æ»¤ç©ºå­—ç¬¦ä¸²
  â†“
è¾“å‡º: ["alumni", "from", "stanford", "5", "years", "experience"]
```

#### ç¤ºä¾‹

| è¾“å…¥ | è¾“å‡º |
|-----|------|
| "Product Manager" | ["product", "manager"] |
| "works at Google" | ["works", "at", "google"] |
| "5-7 years" | ["5", "7", "years"] |
| "Python/JavaScript" | ["python", "javascript"] |
| "Stanford alumni" | ["stanford", "alumni"] |

### 2. æ•°å­—æå–

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬419-422è¡Œ

```swift
private func extractNumbers(from text: String) -> [Double] {
    let components = text.components(separatedBy: CharacterSet(charactersIn: "0123456789").inverted)
    return components.compactMap { Double($0) }
}
```

#### å¤„ç†æµç¨‹

```
è¾“å…¥: "5 years of experience at company #1"
  â†“
æŒ‰éæ•°å­—å­—ç¬¦åˆ†å‰²: ["5", "", "1"]
  â†“
è½¬ Double å¹¶è¿‡æ»¤ nil: [5.0, 1.0]
  â†“
è¾“å‡º: [5.0, 1.0]
```

#### ç”¨é€”

æå–çš„æ•°å­—ä¸»è¦ç”¨äº**å·¥ä½œå¹´é™åŒ¹é…**ï¼š
- æŸ¥è¯¢ï¼š"5 years experience" â†’ æå– [5.0]
- åŒ¹é…ï¼šä¸ç”¨æˆ·çš„ `yearsOfExperience` æ¯”è¾ƒ
- è§„åˆ™ï¼šç›¸å·® â‰¤ 1å¹´åˆ™åŒ¹é…

---

## åŒ¹é…é€»è¾‘è¯¦è§£

### æ··åˆè¯„åˆ†å…¬å¼

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬306-327è¡Œ

```swift
private func rankRecommendations(
    _ recommendations: [(userId: String, score: Double, profile: BrewNetProfile)],
    query: String,
    currentUserProfile: BrewNetProfile?
) -> [BrewNetProfile] {
    let tokens = tokenize(query)
    let numbers = extractNumbers(from: query)
    
    let ranked = recommendations.map { item -> (profile: BrewNetProfile, score: Double) in
        // è®¡ç®—æ–‡æœ¬åŒ¹é…åˆ†æ•°
        let matchScore = computeMatchScore(
            for: item.profile, 
            tokens: tokens, 
            numbers: numbers, 
            currentUserProfile: currentUserProfile
        )
        
        // æ··åˆè¯„åˆ†ï¼šæ¨èåˆ†æ•°30% + æ–‡æœ¬åŒ¹é…70%
        let blendedScore = (item.score * 0.3) + matchScore
        
        return (profile: item.profile, score: blendedScore)
    }
    
    return ranked
        .sorted { $0.score > $1.score }
        .map { $0.profile }
}
```

#### è¯„åˆ†æƒé‡è®¾è®¡

| ç»„æˆéƒ¨åˆ† | æƒé‡ | æ¥æº | ç†ç”± |
|---------|------|------|------|
| **æ¨èç³»ç»Ÿåˆ†æ•°** | 30% | Two-Toweræ¨¡å‹ | åŸºç¡€åŒ¹é…åº¦ |
| **æ–‡æœ¬åŒ¹é…åˆ†æ•°** | 70% | NLPé€»è¾‘ | ç²¾ç¡®æŸ¥è¯¢æ„å›¾ |

**è®¾è®¡æ€è·¯**ï¼š
- æ¨èç³»ç»Ÿæä¾›å¹¿æ³›çš„å€™é€‰æ± ï¼ˆ60äººï¼‰
- æ–‡æœ¬åŒ¹é…ç²¾ç¡®ç­›é€‰å‡ºç¬¦åˆæè¿°çš„å€™é€‰äºº
- æ–‡æœ¬åŒ¹é…æƒé‡æ›´é«˜ï¼Œç¡®ä¿ç»“æœç¬¦åˆæŸ¥è¯¢æ„å›¾

---

### æ–‡æœ¬åŒ¹é…è¯„åˆ†

**ä»£ç ä½ç½®**: `ExploreView.swift` ç¬¬329-402è¡Œ

```swift
private func computeMatchScore(
    for profile: BrewNetProfile,
    tokens: [String],
    numbers: [Double],
    currentUserProfile: BrewNetProfile?
) -> Double {
    var score: Double = 0.0
    let searchableText = aggregatedSearchableText(for: profile)
    let tokenSet = Set(tokens)
    
    // 1. åŸºç¡€å…³é”®è¯åŒ¹é…
    for token in tokenSet {
        if token.count < 2 { continue }
        if searchableText.contains(token) {
            score += 1.0
        }
    }
    
    // 2. å·¥ä½œå¹´é™åŒ¹é…
    if let years = profile.professionalBackground.yearsOfExperience {
        for target in numbers {
            if abs(years - target) <= 1.0 {
                score += 2.0
            }
        }
    }
    
    // 3. Mentor/Mentoring åŒ¹é…
    if tokenSet.contains(where: { $0.contains("mentor") || $0.contains("mentoring") }) {
        if profile.networkingIntention.selectedIntention == .learnGrow ||
            profile.networkingIntention.selectedSubIntentions.contains(.skillDevelopment) ||
            profile.networkingIntention.selectedSubIntentions.contains(.careerDirection) {
            score += 1.5
        }
    }
    
    // 4. æ ¡å‹åŒ¹é…
    if tokenSet.contains(where: { $0.contains("alum") }) {
        // åŸºç¡€åˆ†ï¼šæœ‰æ•™è‚²ç»å†
        if let educations = profile.professionalBackground.educations, !educations.isEmpty {
            score += 1.0
        }
        
        // æ ¡å‹åŠ åˆ†ï¼šåŒä¸€æ‰€å­¦æ ¡
        if let currentUserProfile = currentUserProfile,
           let currentUserEducations = currentUserProfile.professionalBackground.educations,
           let targetEducations = profile.professionalBackground.educations {
            
            let currentUserSchools = Set(currentUserEducations.map { 
                $0.schoolName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines) 
            })
            
            for targetEducation in targetEducations {
                let targetSchool = targetEducation.schoolName.lowercased().trimmingCharacters(in: .whitespacesAndNewlines)
                if currentUserSchools.contains(targetSchool) {
                    score += 5.0  // åŒæ ¡æ ¡å‹å¤§å¹…åŠ åˆ†
                    print("ğŸ“ Alumni match found! School: \(targetEducation.schoolName)")
                    break
                }
            }
        }
    }
    
    // 5. Founder/Startup åŒ¹é…
    if tokenSet.contains("founder") || tokenSet.contains("startup") {
        if profile.professionalBackground.careerStage == .founder ||
            profile.networkingIntention.selectedIntention == .buildCollaborate {
            score += 1.0
        }
    }
    
    return score
}
```

---

## è¯„åˆ†ç®—æ³•

### è§„åˆ™æ±‡æ€»è¡¨

| è§„åˆ™ | è§¦å‘æ¡ä»¶ | åŠ åˆ† | ä»£ç è¡Œ | è¯´æ˜ |
|-----|---------|------|--------|------|
| **åŸºç¡€å…³é”®è¯** | å…³é”®è¯å‡ºç°åœ¨å¯æœç´¢æ–‡æœ¬ä¸­ | +1.0/è¯ | 339-344 | æ¯ä¸ªåŒ¹é…çš„å…³é”®è¯ |
| **å·¥ä½œå¹´é™** | æŸ¥è¯¢æ•°å­—ä¸ç”¨æˆ·å¹´é™ç›¸å·®â‰¤1å¹´ | +2.0 | 346-352 | ç²¾ç¡®å¹´é™åŒ¹é… |
| **Mentoræ„å›¾** | æŸ¥è¯¢å«"mentor" + ç”¨æˆ·æœ‰å­¦ä¹ æ„å›¾ | +1.5 | 354-360 | æ„å›¾åŒ¹é… |
| **æ ¡å‹åŸºç¡€åˆ†** | æŸ¥è¯¢å«"alum" + ç”¨æˆ·æœ‰æ•™è‚²ç»å† | +1.0 | 364-369 | æœ‰æ•™è‚²èƒŒæ™¯ |
| **æ ¡å‹åŠ åˆ†** | åŒä¸€æ‰€å­¦æ ¡ | +5.0 | 371-391 | åŒæ ¡æ ¡å‹ï¼ˆæœ€é‡è¦ï¼‰ |
| **Founder** | æŸ¥è¯¢å«"founder/startup" + ç”¨æˆ·æ˜¯åˆ›å§‹äºº | +1.0 | 394-399 | èŒä¸šé˜¶æ®µåŒ¹é… |

### è¯„åˆ†ç¤ºä¾‹

#### ç¤ºä¾‹ 1: å¯»æ‰¾æ ¡å‹å¯¼å¸ˆ

**æŸ¥è¯¢**: "Stanford alumni with 5 years experience, open to mentoring"

**å€™é€‰äºº A**:
- Stanford æ ¡å‹ âœ“
- 5å¹´ç»éªŒ âœ“
- æœ‰ mentor æ„å›¾ âœ“
- æ¨èåˆ†æ•°: 0.8

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  stanford: +1.0
  alumni: +1.0 (åŸºç¡€)
  years: +1.0
  experience: +1.0
  mentoring: +1.5 (æ„å›¾åŒ¹é…)
  5å¹´ç»éªŒåŒ¹é…: +2.0
  åŒæ ¡åŠ åˆ†: +5.0
  = 12.5

æ··åˆåˆ†æ•°:
  = 0.8 Ã— 0.3 + 12.5 Ã— 1.0
  = 0.24 + 12.5
  = 12.74

æ’å: #1 ğŸ¥‡
```

**å€™é€‰äºº B**:
- Harvard æ ¡å‹ âœ“ (éåŒæ ¡)
- 6å¹´ç»éªŒ âœ“
- æ—  mentor æ„å›¾
- æ¨èåˆ†æ•°: 0.9

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  alumni: +1.0 (åŸºç¡€)
  years: +1.0
  experience: +1.0
  6å¹´ç»éªŒåŒ¹é…: +2.0 (ç›¸å·®1å¹´)
  åŒæ ¡åŠ åˆ†: 0 (ä¸åŒå­¦æ ¡)
  = 5.0

æ··åˆåˆ†æ•°:
  = 0.9 Ã— 0.3 + 5.0 Ã— 1.0
  = 0.27 + 5.0
  = 5.27

æ’å: #2
```

**å€™é€‰äºº C**:
- æ— æ•™è‚²ç»å†
- 5å¹´ç»éªŒ âœ“
- æœ‰ mentor æ„å›¾ âœ“
- æ¨èåˆ†æ•°: 0.85

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  years: +1.0
  experience: +1.0
  mentoring: +1.5
  5å¹´ç»éªŒåŒ¹é…: +2.0
  = 5.5

æ··åˆåˆ†æ•°:
  = 0.85 Ã— 0.3 + 5.5 Ã— 1.0
  = 0.255 + 5.5
  = 5.755

æ’å: #3
```

**ç»“è®º**: åŒæ ¡æ ¡å‹ï¼ˆ+5.0åˆ†ï¼‰çš„åŠ åˆ†éå¸¸æ˜¾è‘—ï¼Œç¡®ä¿æ ¡å‹ä¼˜å…ˆæ’åã€‚

---

#### ç¤ºä¾‹ 2: å¯»æ‰¾åˆ›ä¸šè€…

**æŸ¥è¯¢**: "startup founder with AI experience"

**å€™é€‰äºº A**:
- èŒä¸šé˜¶æ®µ: Founder âœ“
- æŠ€èƒ½: ["AI", "Machine Learning"] âœ“
- æ¨èåˆ†æ•°: 0.75

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  startup: +1.0
  founder: +1.0 (å…³é”®è¯) + 1.0 (èŒä¸šé˜¶æ®µ)
  ai: +1.0
  experience: +1.0
  = 5.0

æ··åˆåˆ†æ•°:
  = 0.75 Ã— 0.3 + 5.0 Ã— 1.0
  = 0.225 + 5.0
  = 5.225

æ’å: #1 ğŸ¥‡
```

**å€™é€‰äºº B**:
- èŒä¸šé˜¶æ®µ: Senior âœ—
- æŠ€èƒ½: ["AI", "Deep Learning"] âœ“
- å·¥ä½œç»å†: åœ¨ startup å·¥ä½œè¿‡
- æ¨èåˆ†æ•°: 0.80

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  startup: +1.0 (å·¥ä½œç»å†ä¸­å‡ºç°)
  ai: +1.0
  experience: +1.0
  = 3.0

æ··åˆåˆ†æ•°:
  = 0.80 Ã— 0.3 + 3.0 Ã— 1.0
  = 0.24 + 3.0
  = 3.24

æ’å: #2
```

---

#### ç¤ºä¾‹ 3: å¯»æ‰¾ç‰¹å®šå¹´é™

**æŸ¥è¯¢**: "product manager with 3 years experience at tech company"

**å€™é€‰äºº A**:
- èŒä½: Product Manager âœ“
- å·¥ä½œå¹´é™: 3.5å¹´ âœ“
- å…¬å¸: Google âœ“
- æ¨èåˆ†æ•°: 0.70

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  product: +1.0
  manager: +1.0
  years: +1.0
  experience: +1.0
  tech: +1.0
  company: +1.0
  3å¹´åŒ¹é…: +2.0 (ç›¸å·®0.5å¹´)
  = 8.0

æ··åˆåˆ†æ•°:
  = 0.70 Ã— 0.3 + 8.0 Ã— 1.0
  = 0.21 + 8.0
  = 8.21

æ’å: #1 ğŸ¥‡
```

**å€™é€‰äºº B**:
- èŒä½: Product Manager âœ“
- å·¥ä½œå¹´é™: 7å¹´ âœ—
- å…¬å¸: Amazon âœ“
- æ¨èåˆ†æ•°: 0.85

```
æ–‡æœ¬åŒ¹é…åˆ†æ•°:
  product: +1.0
  manager: +1.0
  years: +1.0
  experience: +1.0
  tech: +1.0
  company: +1.0
  3å¹´åŒ¹é…: 0 (ç›¸å·®4å¹´)
  = 6.0

æ··åˆåˆ†æ•°:
  = 0.85 Ã— 0.3 + 6.0 Ã— 1.0
  = 0.255 + 6.0
  = 6.255

æ’å: #2
```

**ç»“è®º**: å·¥ä½œå¹´é™åŒ¹é…ï¼ˆ+2.0åˆ†ï¼‰æ˜¾è‘—å½±å“æ’åï¼Œå³ä½¿æ¨èåˆ†æ•°è¾ƒä½ï¼Œç²¾ç¡®åŒ¹é…å¹´é™çš„å€™é€‰äººä»ä¼šæ’åœ¨å‰é¢ã€‚

---

## ä»£ç å®ç°

### æ ¸å¿ƒå‡½æ•°è°ƒç”¨é“¾

```
ExploreMainView.runHeadhuntingSearch()
    â†“
è·å–å½“å‰ç”¨æˆ· profile (é¦–æ¬¡)
    â†“
RecommendationService.getRecommendations(limit: 60)
    â†“
ExploreMainView.rankRecommendations()
    â”œâ”€ tokenize(query)
    â”œâ”€ extractNumbers(query)
    â””â”€ computeMatchScore() Ã— 60
        â”œâ”€ aggregatedSearchableText()
        â”œâ”€ å…³é”®è¯åŒ¹é…
        â”œâ”€ å¹´é™åŒ¹é…
        â”œâ”€ MentoråŒ¹é…
        â”œâ”€ æ ¡å‹åŒ¹é…
        â””â”€ FounderåŒ¹é…
    â†“
æ’åºå¹¶å– Top 5
    â†“
è·å– Pro/Verified çŠ¶æ€
    â†“
æ›´æ–° UI
```

### å…³é”®æ•°æ®ç»“æ„

```swift
// æ¨èå€™é€‰äººç»“æ„
typealias Recommendation = (
    userId: String,
    score: Double,           // æ¨èç³»ç»Ÿåˆ†æ•°
    profile: BrewNetProfile
)

// æ’åºåçš„å€™é€‰äºº
typealias RankedProfile = (
    profile: BrewNetProfile,
    score: Double           // æ··åˆåˆ†æ•°
)
```

### çŠ¶æ€ç®¡ç†

```swift
struct ExploreMainView: View {
    // ç”¨æˆ·è¾“å…¥
    @State private var descriptionText: String = ""
    
    // æœç´¢çŠ¶æ€
    @State private var isLoading = false
    @State private var hasSearched = false
    @State private var errorMessage: String?
    
    // ç»“æœæ•°æ®
    @State private var recommendedProfiles: [BrewNetProfile] = []
    @State private var proUserIds: Set<String> = []
    @State private var verifiedUserIds: Set<String> = []
    
    // å½“å‰ç”¨æˆ· profileï¼ˆç”¨äºæ ¡å‹åŒ¹é…ï¼‰
    @State private var currentUserProfile: BrewNetProfile? = nil
    
    // äº¤äº’çŠ¶æ€
    @State private var selectedProfile: BrewNetProfile?
    @State private var engagedProfileIds: Set<String> = []
}
```

### é”™è¯¯å¤„ç†

```swift
do {
    let recommendations = try await recommendationService.getRecommendations(...)
    // ... å¤„ç†ç»“æœ
} catch {
    await MainActor.run {
        self.isLoading = false
        self.recommendedProfiles = []
        self.errorMessage = "Unable to complete the headhunting request. Please try again shortly."
        print("âŒ Headhunting search failed: \(error.localizedDescription)")
    }
}
```

---

## ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: å¯»æ‰¾æ ¡å‹å¯¼å¸ˆ

**ç”¨æˆ·èƒŒæ™¯**:
- å­¦æ ¡: Stanford University
- èŒä½: Junior Product Manager
- ç»éªŒ: 2å¹´

**è¾“å…¥æŸ¥è¯¢**:
```
"Stanford alumni, senior product manager, willing to mentor"
```

**åŒ¹é…åˆ†æ**:

| å€™é€‰äºº | åŒ¹é…ç‚¹ | åˆ†æ•° | æ’å |
|-------|--------|------|------|
| Sarah Chen | Stanford âœ“, Senior PM âœ“, Mentoræ„å›¾ âœ“ | 12.8 | #1 |
| Michael Wang | Stanford âœ“, Director âœ“, Mentoræ„å›¾ âœ“ | 11.5 | #2 |
| Lisa Park | Harvard âœ“, Senior PM âœ“, Mentoræ„å›¾ âœ“ | 6.2 | #3 |
| John Smith | Stanford âœ“, Engineer âœ—, æ— Mentoræ„å›¾ | 7.0 | #4 |
| Emily Johnson | Stanford âœ“, Senior Designer âœ— | 6.5 | #5 |

**å…³é”®è¯å‘½ä¸­**:
- "stanford": æ‰€æœ‰ Stanford å€™é€‰äºº +1.0
- "alumni": æ‰€æœ‰æœ‰æ•™è‚²èƒŒæ™¯çš„ +1.0ï¼ŒStanford æ ¡å‹é¢å¤– +5.0
- "senior": +1.0
- "product", "manager": å„ +1.0
- "mentor": æœ‰æ„å›¾çš„ +1.5

---

### åœºæ™¯ 2: å¯»æ‰¾åˆ›ä¸šä¼™ä¼´

**ç”¨æˆ·èƒŒæ™¯**:
- èŒä¸šé˜¶æ®µ: Early Career
- æŠ€èƒ½: AI, Python
- æ„å›¾: Build & Collaborate

**è¾“å…¥æŸ¥è¯¢**:
```
"startup founder, AI background, open to collaboration"
```

**åŒ¹é…åˆ†æ**:

| å€™é€‰äºº | åŒ¹é…ç‚¹ | åˆ†æ•° | æ’å |
|-------|--------|------|------|
| Alex Zhang | Founder âœ“, AI/ML âœ“, Buildæ„å›¾ âœ“ | 8.5 | #1 |
| Rachel Lee | Founder âœ“, Biotech âœ—, Buildæ„å›¾ âœ“ | 5.2 | #2 |
| David Kim | Senior Engineer âœ—, AI âœ“, Buildæ„å›¾ âœ“ | 4.8 | #3 |
| Sophie Liu | Founder âœ“, Design âœ— | 4.0 | #4 |
| James Park | Early Career âœ—, AI âœ“ | 3.5 | #5 |

**å…³é”®è¯å‘½ä¸­**:
- "startup", "founder": Founderé˜¶æ®µ +1.0 + å…³é”®è¯ +1.0
- "ai", "background": +2.0
- "collaboration": +1.0
- Buildæ„å›¾åŠ æˆ: +1.0

---

### åœºæ™¯ 3: å¯»æ‰¾ç‰¹å®šç»éªŒ

**ç”¨æˆ·èƒŒæ™¯**:
- è¡Œä¸š: Finance
- èŒä½: Analyst

**è¾“å…¥æŸ¥è¯¢**:
```
"investment banking analyst, 3-5 years experience"
```

**åŒ¹é…åˆ†æ**:

| å€™é€‰äºº | åŒ¹é…ç‚¹ | åˆ†æ•° | æ’å |
|-------|--------|------|------|
| Mark Chen | IB Analyst âœ“, 4å¹´ âœ“ | 8.0 | #1 |
| Jessica Wu | IB Associate âœ“, 6å¹´ âœ— | 5.5 | #2 |
| Kevin Zhang | Analyst âœ“, 3å¹´ âœ“, Techè¡Œä¸š âœ— | 6.0 | #3 |
| Amy Lin | IB Analyst âœ“, 1å¹´ âœ— | 4.5 | #4 |
| Chris Wang | Consultant âœ—, 4å¹´ âœ“ | 3.8 | #5 |

**å…³é”®è¯å‘½ä¸­**:
- "investment", "banking", "analyst": å„ +1.0
- "experience": +1.0
- å¹´é™åŒ¹é…: 3-5å¹´èŒƒå›´å†… +2.0

---

## æ€§èƒ½ä¼˜åŒ–

### 1. å€™é€‰æ± å¤§å°

**å½“å‰è®¾ç½®**: 60äºº

```swift
let recommendations = try await recommendationService.getRecommendations(
    for: currentUser.id,
    limit: 60,  // å€™é€‰æ± å¤§å°
    forceRefresh: true
)
```

**æƒè¡¡**:
- å¤ªå°ï¼ˆå¦‚20ï¼‰ï¼šå¯èƒ½é—æ¼å¥½çš„åŒ¹é…
- å¤ªå¤§ï¼ˆå¦‚200ï¼‰ï¼šè®¡ç®—å¼€é”€å¤§ï¼Œå“åº”æ…¢
- **60äºº**ï¼šå¹³è¡¡äº†è¦†ç›–ç‡å’Œæ€§èƒ½

### 2. æ–‡æœ¬å¤„ç†ä¼˜åŒ–

#### å½“å‰å®ç°
```swift
// ç®€å•çš„å°å†™ + åˆ†è¯
let searchableText = aggregatedSearchableText(for: profile).lowercased()
```

#### å¯èƒ½ä¼˜åŒ–
```swift
// 1. ç¼“å­˜å¯æœç´¢æ–‡æœ¬ï¼ˆé¿å…é‡å¤è®¡ç®—ï¼‰
private var searchableTextCache: [String: String] = [:]

// 2. æå‰è®¡ç®—å¹¶å­˜å‚¨åœ¨æ•°æ®åº“
// user_features è¡¨æ·»åŠ  searchable_text åˆ—

// 3. ä½¿ç”¨æ›´é«˜æ•ˆçš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•
// ä¾‹å¦‚: Boyer-Moore, KMP
```

### 3. å¹¶å‘å¤„ç†

#### å½“å‰å®ç°ï¼ˆä¸²è¡Œï¼‰
```swift
for profile in profiles {
    let score = computeMatchScore(for: profile, ...)
}
```

#### ä¼˜åŒ–æ–¹æ¡ˆï¼ˆå¹¶è¡Œï¼‰
```swift
let scores = await withTaskGroup(of: (profile: BrewNetProfile, score: Double).self) { group in
    for profile in profiles {
        group.addTask {
            let score = computeMatchScore(for: profile, ...)
            return (profile, score)
        }
    }
    
    var results: [(BrewNetProfile, Double)] = []
    for await result in group {
        results.append(result)
    }
    return results
}
```

**æ”¶ç›Š**: 
- 60ä¸ªå€™é€‰äººçš„è¯„åˆ†è®¡ç®—å¯å¹¶è¡Œ
- é¢„è®¡å¯å‡å°‘ 50-70% è®¡ç®—æ—¶é—´

### 4. ç´¢å¼•ä¼˜åŒ–

#### æ•°æ®åº“ç´¢å¼•
```sql
-- user_features è¡¨
CREATE INDEX idx_user_features_location ON user_features(location);
CREATE INDEX idx_user_features_industry ON user_features(industry);
CREATE INDEX idx_user_features_career_stage ON user_features(career_stage);

-- profiles è¡¨ï¼ˆJSONBï¼‰
CREATE INDEX idx_profiles_searchable_gin 
ON profiles USING gin ((
    lower(core_identity->>'name') || ' ' ||
    lower(professional_background->>'current_company') || ' ' ||
    lower(professional_background->>'job_title')
));
```

### 5. å“åº”æ—¶é—´åˆ†æ

| æ­¥éª¤ | å¹³å‡è€—æ—¶ | å æ¯” |
|-----|---------|------|
| è·å–æ¨èå€™é€‰æ±  | 500ms | 50% |
| æ–‡æœ¬å¤„ç†ï¼ˆ60äººï¼‰ | 100ms | 10% |
| è¯„åˆ†è®¡ç®—ï¼ˆ60äººï¼‰ | 300ms | 30% |
| æ’åº | 10ms | 1% |
| UIæ›´æ–° | 90ms | 9% |
| **æ€»è®¡** | **1000ms** | **100%** |

**ä¼˜åŒ–ç›®æ ‡**: é™è‡³ < 500ms

---

## æœªæ¥æ‰©å±•

### 1. è¯­ä¹‰ç†è§£å¢å¼º

#### å½“å‰å±€é™
- åªæ”¯æŒå…³é”®è¯åŒ¹é…
- æ— æ³•ç†è§£åŒä¹‰è¯
- ä¸æ”¯æŒå¤æ‚è¯­ä¹‰

#### æ‰©å±•æ–¹æ¡ˆ

**æ–¹æ¡ˆ A: åŒä¹‰è¯è¯å…¸**
```swift
let synonyms: [String: [String]] = [
    "mentor": ["coach", "advisor", "guide", "teacher"],
    "founder": ["entrepreneur", "startup owner", "ceo"],
    "alumni": ["graduate", "alum", "former student"]
]

// æ‰©å±•æŸ¥è¯¢å…³é”®è¯
var expandedTokens = tokens
for token in tokens {
    if let syns = synonyms[token] {
        expandedTokens.append(contentsOf: syns)
    }
}
```

**æ–¹æ¡ˆ B: è¯åµŒå…¥ (Word Embeddings)**
```swift
// ä½¿ç”¨é¢„è®­ç»ƒçš„è¯å‘é‡
import NaturalLanguage

let embedding = NLEmbedding.wordEmbedding(for: .english)
let querySimilarity = embedding?.distance(between: "mentor", and: "coach")
// è®¡ç®—è¯­ä¹‰ç›¸ä¼¼åº¦ï¼Œè€Œä¸æ˜¯ç²¾ç¡®åŒ¹é…
```

**æ–¹æ¡ˆ C: å¤§è¯­è¨€æ¨¡å‹**
```swift
// ä½¿ç”¨ GPT/Claude API ç†è§£æŸ¥è¯¢æ„å›¾
let prompt = """
Extract the following from the query: "\(userQuery)"
- Job titles
- Skills
- Years of experience
- Special attributes (mentor, founder, etc.)
- Educational background
"""

let response = await callLLM(prompt: prompt)
// ç»“æ„åŒ–æå–æŸ¥è¯¢æ„å›¾
```

### 2. ä¸ªæ€§åŒ–æ’åº

#### åŸºäºå†å²è¡Œä¸º
```swift
// è®°å½•ç”¨æˆ·çš„ç‚¹å‡»ã€é‚€è¯·ã€æ‹’ç»è¡Œä¸º
struct UserPreference {
    let userId: String
    let clickedProfiles: [String]
    let invitedProfiles: [String]
    let rejectedProfiles: [String]
}

// å­¦ä¹ ç”¨æˆ·åå¥½
func adjustScore(
    baseScore: Double, 
    profile: BrewNetProfile, 
    userPreference: UserPreference
) -> Double {
    var adjusted = baseScore
    
    // å¦‚æœç”¨æˆ·ç»å¸¸ç‚¹å‡»æŸç±»å€™é€‰äººï¼Œæå‡ç±»ä¼¼å€™é€‰äººçš„åˆ†æ•°
    if userPrefersType(profile, userPreference) {
        adjusted *= 1.2
    }
    
    return adjusted
}
```

### 3. æŸ¥è¯¢å»ºè®®

#### è‡ªåŠ¨å®Œæˆ
```swift
// åŸºäºå¸¸è§æŸ¥è¯¢æ¨¡å¼æä¾›å»ºè®®
let commonQueries = [
    "alumni from [university]",
    "mentor with [skill] experience",
    "[N] years experience in [field]",
    "startup founder in [industry]"
]

// å±•ç¤ºä¸ºå¿«é€Ÿé€‰æ‹©æŒ‰é’®
```

#### æŸ¥è¯¢æ‰©å±•
```swift
// ç”¨æˆ·è¾“å…¥: "AI engineer"
// ç³»ç»Ÿå»ºè®®:
// - "AI engineer with 5 years experience"
// - "senior AI engineer at tech company"
// - "AI engineer willing to mentor"
```

### 4. å¤šè¯­è¨€æ”¯æŒ

```swift
// è‡ªåŠ¨æ£€æµ‹æŸ¥è¯¢è¯­è¨€
let language = NLLanguageRecognizer.dominantLanguage(for: userQuery)

switch language {
case .english:
    processEnglishQuery(userQuery)
case .chinese:
    processChineseQuery(userQuery)
default:
    // ç¿»è¯‘åˆ°è‹±è¯­åå¤„ç†
    let translatedQuery = translate(userQuery, to: .english)
    processEnglishQuery(translatedQuery)
}
```

### 5. é«˜çº§è¿‡æ»¤

#### UIå¢å¼º
```swift
struct HeadhuntingFilters {
    var minExperience: Int?
    var maxExperience: Int?
    var industries: [String]
    var locations: [String]
    var onlyVerified: Bool
    var onlyProUsers: Bool
    var availableForMentoring: Bool
}

// åœ¨æ–‡æœ¬æœç´¢åŸºç¡€ä¸Šå åŠ è¿‡æ»¤æ¡ä»¶
```

### 6. ç»“æœè§£é‡Š

#### å±•ç¤ºåŒ¹é…ç†ç”±
```swift
struct MatchReason {
    let score: Double
    let reasons: [String]
    
    // ä¾‹å¦‚:
    // reasons = [
    //     "Same school (Stanford)",
    //     "5 years experience (exact match)",
    //     "Open to mentoring"
    // ]
}

// åœ¨ç»“æœå¡ç‰‡ä¸­æ˜¾ç¤º
VStack {
    Text("Why matched:")
    ForEach(matchReason.reasons) { reason in
        HStack {
            Image(systemName: "checkmark.circle.fill")
            Text(reason)
        }
    }
}
```

### 7. A/B æµ‹è¯•æ¡†æ¶

```swift
enum RankingStrategy {
    case current              // å½“å‰ç®—æ³•
    case semanticEnhanced     // è¯­ä¹‰å¢å¼ºç‰ˆæœ¬
    case personalizedLearning // ä¸ªæ€§åŒ–å­¦ä¹ ç‰ˆæœ¬
}

struct ABTestConfig {
    let userId: String
    let strategy: RankingStrategy
    
    static func assignStrategy(for userId: String) -> RankingStrategy {
        // æŒ‰ç”¨æˆ·IDå“ˆå¸Œåˆ†é…ç­–ç•¥
        let hash = abs(userId.hashValue)
        let bucket = hash % 100
        
        switch bucket {
        case 0..<33:
            return .current
        case 33..<66:
            return .semanticEnhanced
        default:
            return .personalizedLearning
        }
    }
}

// è®°å½•æŒ‡æ ‡
struct RankingMetrics {
    let strategy: RankingStrategy
    let clickThroughRate: Double
    let invitationRate: Double
    let responseTime: TimeInterval
}
```

---

## æ€§èƒ½æŒ‡æ ‡

### å½“å‰æ€§èƒ½åŸºå‡†

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | çŠ¶æ€ |
|-----|--------|--------|------|
| å¹³å‡å“åº”æ—¶é—´ | 1000ms | < 500ms | ğŸŸ¡ éœ€ä¼˜åŒ– |
| å€™é€‰æ± å¤§å° | 60äºº | - | âœ… åˆç† |
| Top 5 å‡†ç¡®ç‡ | ä¼°è®¡ 80% | > 90% | ğŸŸ¡ éœ€æå‡ |
| å†…å­˜ä½¿ç”¨ | < 50MB | < 30MB | âœ… è‰¯å¥½ |
| å´©æºƒç‡ | < 0.1% | < 0.1% | âœ… ç¨³å®š |

### ç”¨æˆ·ä½“éªŒæŒ‡æ ‡

| æŒ‡æ ‡ | æè¿° | å½“å‰çŠ¶æ€ |
|-----|------|---------|
| æ˜“ç”¨æ€§ | ç”¨æˆ·èƒ½å¦è½»æ¾è¡¨è¾¾éœ€æ±‚ | ğŸŸ¢ é«˜ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰ |
| å‡†ç¡®æ€§ | ç»“æœæ˜¯å¦ç¬¦åˆæœŸæœ› | ğŸŸ¡ ä¸­ï¼ˆå¾…æ”¶é›†åé¦ˆï¼‰ |
| å“åº”é€Ÿåº¦ | 1ç§’å†…è¿”å›ç»“æœ | ğŸŸ¡ ä¸­ï¼ˆ1ç§’å·¦å³ï¼‰ |
| å¤šæ ·æ€§ | Top 5 æ˜¯å¦æœ‰è¶³å¤Ÿå·®å¼‚ | ğŸŸ¢ é«˜ |

---

## æµ‹è¯•ç”¨ä¾‹

### åŠŸèƒ½æµ‹è¯•

```swift
class HeadhuntingTests: XCTestCase {
    
    // 1. åŸºç¡€å…³é”®è¯åŒ¹é…
    func testBasicKeywordMatching() {
        let query = "product manager at Google"
        let tokens = tokenize(query)
        
        XCTAssertTrue(tokens.contains("product"))
        XCTAssertTrue(tokens.contains("manager"))
        XCTAssertTrue(tokens.contains("google"))
    }
    
    // 2. æ•°å­—æå–
    func testNumberExtraction() {
        let query = "5 years of experience"
        let numbers = extractNumbers(from: query)
        
        XCTAssertEqual(numbers, [5.0])
    }
    
    // 3. æ ¡å‹åŒ¹é…
    func testAlumniMatching() {
        let currentUser = createMockUser(school: "Stanford")
        let candidate1 = createMockProfile(school: "Stanford")
        let candidate2 = createMockProfile(school: "Harvard")
        
        let score1 = computeMatchScore(
            for: candidate1, 
            tokens: ["alumni"], 
            numbers: [],
            currentUserProfile: currentUser
        )
        
        let score2 = computeMatchScore(
            for: candidate2, 
            tokens: ["alumni"], 
            numbers: [],
            currentUserProfile: currentUser
        )
        
        // Stanford æ ¡å‹åº”è¯¥å¾—åˆ†æ›´é«˜
        XCTAssertTrue(score1 > score2)
        XCTAssertEqual(score1 - score2, 5.0) // æ ¡å‹åŠ åˆ†
    }
    
    // 4. å¹´é™åŒ¹é…
    func testExperienceMatching() {
        let candidate1 = createMockProfile(yearsOfExperience: 5.0)
        let candidate2 = createMockProfile(yearsOfExperience: 10.0)
        
        let score1 = computeMatchScore(
            for: candidate1, 
            tokens: ["experience"], 
            numbers: [5.0],
            currentUserProfile: nil
        )
        
        let score2 = computeMatchScore(
            for: candidate2, 
            tokens: ["experience"], 
            numbers: [5.0],
            currentUserProfile: nil
        )
        
        // 5å¹´ç»éªŒçš„å€™é€‰äººåº”è¯¥å¾—åˆ†æ›´é«˜
        XCTAssertTrue(score1 > score2)
    }
    
    // 5. æ··åˆè¯„åˆ†
    func testBlendedScoring() {
        let recommendations = [
            (userId: "1", score: 0.8, profile: profile1),
            (userId: "2", score: 0.6, profile: profile2)
        ]
        
        let ranked = rankRecommendations(
            recommendations, 
            query: "test query",
            currentUserProfile: nil
        )
        
        // éªŒè¯æ’åºæ­£ç¡®
        XCTAssertTrue(ranked[0].score > ranked[1].score)
    }
}
```

---

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. æ²¡æœ‰è¿”å›ç»“æœ

**ç—‡çŠ¶**: æœç´¢åæ˜¾ç¤º "No perfect fits yet"

**å¯èƒ½åŸå› **:
- å€™é€‰æ± å¤ªå°ï¼ˆ< 60äººï¼‰
- æŸ¥è¯¢è¿‡äºå…·ä½“ï¼Œæ— äººåŒ¹é…
- æ‰€æœ‰å€™é€‰äººéƒ½è¢«æ’é™¤ï¼ˆå·²è¿æ¥/å·²æ‹’ç»ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
```swift
// æ£€æŸ¥å€™é€‰æ± å¤§å°
print("ğŸ“Š Candidate pool size: \(recommendations.count)")

// æ£€æŸ¥æ’é™¤åˆ—è¡¨
print("ğŸš« Excluded users: \(excludedUserIds.count)")

// æ”¾å®½åŒ¹é…æ¡ä»¶
// - å‡å°‘å¿…é¡»å…³é”®è¯
// - æ‰©å¤§å¹´é™èŒƒå›´ï¼ˆÂ±2å¹´ï¼‰
```

#### 2. è¿”å›ä¸ç›¸å…³çš„ç»“æœ

**ç—‡çŠ¶**: Top 5 ä¸­æœ‰æ˜æ˜¾ä¸ç¬¦åˆçš„å€™é€‰äºº

**å¯èƒ½åŸå› **:
- å…³é”®è¯è¿‡äºé€šç”¨
- æ¨èç³»ç»Ÿæƒé‡è¿‡é«˜
- æŸäº›å­—æ®µæ•°æ®è´¨é‡å·®

**è§£å†³æ–¹æ¡ˆ**:
```swift
// è°ƒæ•´æƒé‡
let blendedScore = (item.score * 0.2) + matchScore  // é™ä½æ¨èæƒé‡

// æ·»åŠ ç¡¬æ€§è¿‡æ»¤
if profile.professionalBackground.currentCompany == nil {
    continue  // è·³è¿‡æ— å…¬å¸ä¿¡æ¯çš„å€™é€‰äºº
}
```

#### 3. å“åº”æ—¶é—´è¿‡é•¿

**ç—‡çŠ¶**: è¶…è¿‡2ç§’æ‰è¿”å›ç»“æœ

**å¯èƒ½åŸå› **:
- ç½‘ç»œå»¶è¿Ÿ
- æ•°æ®åº“æŸ¥è¯¢æ…¢
- è¯„åˆ†è®¡ç®—å¯†é›†

**è°ƒè¯•**:
```swift
let start = Date()

let step1 = Date()
let recommendations = try await recommendationService.getRecommendations(...)
print("â±ï¸ Get recommendations: \(Date().timeIntervalSince(step1))s")

let step2 = Date()
let ranked = rankRecommendations(...)
print("â±ï¸ Rank recommendations: \(Date().timeIntervalSince(step2))s")

let step3 = Date()
// ... è·å–Pro/VerifiedçŠ¶æ€
print("â±ï¸ Get statuses: \(Date().timeIntervalSince(step3))s")

print("â±ï¸ Total: \(Date().timeIntervalSince(start))s")
```

---

## ç›‘æ§ä¸åˆ†æ

### å…³é”®æŒ‡æ ‡

```swift
// è®°å½•æœç´¢æŒ‡æ ‡
struct HeadhuntingMetrics {
    let timestamp: Date
    let userId: String
    let query: String
    let candidatePoolSize: Int
    let resultsCount: Int
    let responseTime: TimeInterval
    let topScores: [Double]
}

// å‘é€åˆ°åˆ†æå¹³å°
func logHeadhuntingSearch(metrics: HeadhuntingMetrics) {
    Analytics.track("headhunting_search", properties: [
        "query_length": metrics.query.count,
        "candidate_pool_size": metrics.candidatePoolSize,
        "results_count": metrics.resultsCount,
        "response_time": metrics.responseTime,
        "avg_score": metrics.topScores.reduce(0, +) / Double(metrics.topScores.count)
    ])
}
```

### ç”¨æˆ·åé¦ˆæ”¶é›†

```swift
// åœ¨ç»“æœé¡µé¢æ·»åŠ åé¦ˆæŒ‰é’®
struct ResultFeedback {
    let wasHelpful: Bool
    let selectedProfiles: [String]
    let invitedProfiles: [String]
}

// åˆ†æåé¦ˆæ”¹è¿›ç®—æ³•
func analyzeResultQuality() {
    // - å“ªäº›æŸ¥è¯¢ç±»å‹æœ€æˆåŠŸï¼Ÿ
    // - å“ªäº›åŒ¹é…è§„åˆ™æœ€æœ‰æ•ˆï¼Ÿ
    // - ç”¨æˆ·æœ€å¸¸ç‚¹å‡»å“ªä¸ªæ’åçš„å€™é€‰äººï¼Ÿ
}
```

---

## æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿

1. **è‡ªç„¶è¯­è¨€è¾“å…¥** - æ— éœ€å­¦ä¹ å¤æ‚è¯­æ³•
2. **å¤šç»´åº¦åŒ¹é…** - ç»¼åˆ6+ç§åŒ¹é…è§„åˆ™
3. **æ™ºèƒ½æ’åº** - æ··åˆæ¨èå’Œæ–‡æœ¬åŒ¹é…
4. **æ ¡å‹ä¼˜å…ˆ** - åŒæ ¡æ ¡å‹æ˜¾è‘—åŠ åˆ†
5. **å®æ—¶åé¦ˆ** - 1ç§’å†…è¿”å›ç»“æœ

### å½“å‰é™åˆ¶

1. **è¯­ä¹‰ç†è§£æœ‰é™** - ä»…æ”¯æŒå…³é”®è¯åŒ¹é…
2. **æ— ä¸ªæ€§åŒ–** - æ‰€æœ‰ç”¨æˆ·ä½¿ç”¨ç›¸åŒè§„åˆ™
3. **æ— å­¦ä¹ èƒ½åŠ›** - ä¸ä¼šæ ¹æ®åé¦ˆæ”¹è¿›
4. **å€™é€‰æ± å›ºå®š** - 60äººå¯èƒ½é—æ¼å¥½å€™é€‰äºº
5. **æ— ç»“æœè§£é‡Š** - ä¸æ˜¾ç¤ºåŒ¹é…ç†ç”±

### æ”¹è¿›è·¯çº¿å›¾

| é˜¶æ®µ | åŠŸèƒ½ | é¢„è®¡æ”¶ç›Š | ä¼˜å…ˆçº§ |
|-----|------|---------|--------|
| **Phase 1** | å¹¶å‘ä¼˜åŒ– | å“åº”æ—¶é—´ -50% | ğŸ”´ é«˜ |
| **Phase 2** | åŒä¹‰è¯æ‰©å±• | å¬å›ç‡ +20% | ğŸŸ¡ ä¸­ |
| **Phase 3** | ä¸ªæ€§åŒ–æ’åº | å‡†ç¡®ç‡ +15% | ğŸŸ¢ ä½ |
| **Phase 4** | è¯­ä¹‰ç†è§£ï¼ˆLLMï¼‰ | ç”¨æˆ·ä½“éªŒ +30% | ğŸŸ¢ ä½ |
| **Phase 5** | ç»“æœè§£é‡Š | é€æ˜åº¦ +100% | ğŸŸ¡ ä¸­ |

---

## é™„å½•

### A. å®Œæ•´ä»£ç ç»“æ„

```
BrewNet/
â”œâ”€â”€ ExploreView.swift
â”‚   â”œâ”€â”€ ExploreMainView          (ä¸»è§†å›¾)
â”‚   â”œâ”€â”€ runHeadhuntingSearch()   (æœç´¢æ‰§è¡Œ)
â”‚   â”œâ”€â”€ rankRecommendations()    (æ’åºé€»è¾‘)
â”‚   â”œâ”€â”€ computeMatchScore()      (è¯„åˆ†è®¡ç®—)
â”‚   â”œâ”€â”€ aggregatedSearchableText() (æ–‡æœ¬èšåˆ)
â”‚   â”œâ”€â”€ tokenize()               (åˆ†è¯)
â”‚   â”œâ”€â”€ extractNumbers()         (æ•°å­—æå–)
â”‚   â”œâ”€â”€ HeadhuntingResultCard    (ç»“æœå¡ç‰‡)
â”‚   â””â”€â”€ HeadhuntingProfileCardSheet (è¯¦æƒ…é¡µ)
â”œâ”€â”€ RecommendationService.swift
â”‚   â””â”€â”€ getRecommendations()     (è·å–å€™é€‰æ± )
â”œâ”€â”€ ProfileModels.swift
â”‚   â”œâ”€â”€ BrewNetProfile           (ç”¨æˆ·èµ„æ–™)
â”‚   â”œâ”€â”€ CoreIdentity
â”‚   â”œâ”€â”€ ProfessionalBackground
â”‚   â”œâ”€â”€ NetworkingIntention
â”‚   â””â”€â”€ ...
â””â”€â”€ SupabaseService.swift
    â”œâ”€â”€ getProfile()             (è·å–èµ„æ–™)
    â”œâ”€â”€ getProUserIds()          (è·å–ProçŠ¶æ€)
    â””â”€â”€ getVerifiedUserIds()     (è·å–éªŒè¯çŠ¶æ€)
```

### B. å‚è€ƒèµ„æ–™

- **Two-Toweræ¨¡å‹**: `SimpleTwoTowerEncoder.swift`
- **ç”¨æˆ·ç‰¹å¾**: `USER_FEATURES_DOCUMENTATION.md`
- **æ¨èç³»ç»Ÿ**: `RecommendationService.swift`
- **è¡Œä¸ºæŒ‡æ ‡**: `add_behavioral_metrics_to_user_features.sql`

### C. è”ç³»æ–¹å¼

**æŠ€æœ¯è´Ÿè´£äºº**: BrewNet Dev Team Heady  
**æ–‡æ¡£ç»´æŠ¤**: éšä»£ç æ›´æ–°  
**åé¦ˆæ¸ é“**: GitHub Issues / å†…éƒ¨æ–‡æ¡£

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024-11-21  
**é€‚ç”¨ä»£ç ç‰ˆæœ¬**: nlp branch  
**ä»£ç æ–‡ä»¶**: `BrewNet/ExploreView.swift`

